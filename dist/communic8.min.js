var Communic8=function(r){function e(t){if(n[t])return n[t].exports;var i=n[t]={exports:{},id:t,loaded:!1};return r[t].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=r,e.c=n,e.p="",e(0)}([function(r,e,n){(function(r){"use strict";function n(r){return Array.isArray(r)?r:Array.from(r)}function t(r){if(Array.isArray(r)){for(var e=0,n=Array(r.length);r.length>e;e++)n[e]=r[e];return n}return Array.from(r)}function i(r){function e(r){var e=[],n=0;return o.forEach(function(t){var i=void 0,o=t.deserialize(r,n),a=h(o,2);i=a[0],n=a[1],e.push(i)}),e}var n=r.id,i=r.input,o=r.output;return function(){for(var r,o=arguments.length,a=Array(o),u=0;o>u;u++)a[u]=arguments[u];return{data:(r=[n]).concat.apply(r,t(a.map(function(r,e){return i[e].serialize(r)}))),deserializer:e}}}function o(r){function e(){!(n[0]&g)||n[0]&y||n[0]&m||(n.slice(1).forEach(function(r){return o.next(r)}),n[0]&=~g)}var n=r.gpio,t=r.subscribe,i=void 0,o=regeneratorRuntime.mark(function a(){var r,e,n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:case 1:return void(t.next=3);case 3:if(t.t0=t.sent,0!==t.t0){t.next=7;break}t.next=1;break;case 7:return void(t.next=9);case 9:return r=t.sent,t.t1=256*r,void(t.next=13);case 13:t.t2=t.sent,r=t.t1+t.t2,e=Array(r),n=0;case 17:if(r<=n){t.next=24;break}return void(t.next=20);case 20:e[n]=t.sent;case 21:n++,t.next=17;break;case 24:i&&i(e),t.next=0;break;case 27:case"end":return t.stop()}},a,this)})();return o.next(),function(r){if(i)throw Error("Don't make a new call to connect() without stop()ping the old one");i=r;var n=t(e);return function(){n(),i=null}}}function a(r){if(A)throw Error("Trying to start polling when already polling");x=r,A=!0,requestAnimationFrame(s)}function u(r){b.push.apply(b,[z,Math.floor(r.length/256),r.length%256].concat(t(r)))}function c(r){pico8_gpio.fill(0),pico8_gpio[0]=y|g;for(var e=0;r.length>e;e++)pico8_gpio[e+1]=r[e]}function f(){return!(pico8_gpio[0]&g)&!(pico8_gpio[0]&m)}function l(){b.length>0&&f()&&c(b.splice(0,w))}function s(){A&&(x(),l(),requestAnimationFrame(s))}function p(){x=null,A=!1}function d(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,e=r.reader,i=r.writer,o={},a=e(function(r){var e=n(r),t=e[0],i=e.slice(1);if(!o.hasOwnProperty(t))throw Error("Got a response for non-expected message with id '"+t+"'");var a=o[t];delete o[t],a.resolve(a.deserializer(i))}),u=0;return{send:function(r){var e=r.deserializer,n=r.data;return new Promise(function(r,a){for(;o.hasOwnProperty(u);)u=(u+1)%256;i([u].concat(t(n))),o[u]={resolve:r,deserializer:e}})},stop:function(){a()}}}var h=function(){function r(r,e){var n=[],t=!0,i=!1,o=void 0;try{for(var a,u=r[Symbol.iterator]();!(t=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);t=!0);}catch(c){i=!0,o=c}finally{try{!t&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return r(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(e,"__esModule",{value:!0}),e.RPC=i,e._makeReader=o,e.connect=d,("undefined"!=typeof window?window:r).pico8_gpio=Array(128).fill(0);var v=e.ArgTypes={Boolean:{serialize:function(r){return[r?1:0]},deserialize:function(r,e){return[0!==r[e],e+1]}},Byte:{serialize:function(r){return[r]},deserialize:function(r,e){return[r[e],e+1]}},Number:{serialize:function(r){var e=Math.floor(r),n=r%1,t=0;return 0>e&&(t=Math.pow(2,7),e+=32768),[Math.floor(e/256)|t,e%256,Math.floor(256*n),Math.floor(256*n*256%256)]},deserialize:function(r,e){var n=r[e],t=r[e+1],i=r[e+2],o=r[e+3],a=0!==(n&Math.pow(2,7)),u=0;return a&&(n&=~Math.pow(2,7),u=-32768),[256*n+t+i/256+o/65536+u,e+4]}},Array:function(r){return{serialize:function(e){var n;return(n=[Math.floor(e.length/256),e.length%256]).concat.apply(n,t(e.map(r.serialize)))},deserialize:function(e,n){var t=256*e[n]+e[n+1];n+=2;for(var i=[],o=0;t>o;o++){var a=void 0,u=r.deserialize(e,n),c=h(u,2);a=c[0],n=c[1],i.push(a)}return[i,n]}}},Tuple:function(){for(var r=arguments.length,e=Array(r),n=0;r>n;n++)e[n]=arguments[n];return{serialize:function(r){var n;return(n=[]).concat.apply(n,t(e.map(function(e,n){return e.serialize(r[n])})))},deserialize:function(r,n){var t=[];return e.forEach(function(e){var i=void 0,o=e.deserialize(r,n),a=h(o,2);i=a[0],n=a[1],t.push(i)}),[t,n]}}},String:{serialize:function(r){return[Math.floor(r.length/256),r.length%256].concat(t(r.split("").map(function(r){return r.charCodeAt(0)})))},deserialize:function(r,e){var n=256*r[e]+r[e+1],t="";e+=2;for(var i=0;n>i;i++)t+=String.fromCharCode(r[e+i]);return[t,e+n]}},Unspecify:function(r){return{serialize:function(e){var n=r.serialize(e);return[Math.floor(n.length/256),n.length%256].concat(t(n))},deserialize:function(e,n){return r.deserialize(e,n+2)}}}};v.Unspecified=v.Array(v.Byte);var g=1,y=2,m=4,z=1,w=127,x=null,A=!1,b=[],M=o({gpio:pico8_gpio,subscribe:function(r){return a(r),p}}),_={reader:M,writer:u}}).call(e,function(){return this}())}]);